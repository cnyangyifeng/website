<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mocktpo.mapper.LicenseMapper">

    <cache type="org.mybatis.caches.ehcache.EhcacheCache"/>

    <select id="find" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        ORDER BY
        MT_LICENSE.MT_DATE_UPDATED DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="findById" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_LICENSE_ID = #{licenseId}
    </select>

    <select id="findByEmail" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_EMAIL = #{email}
        ORDER BY
        MT_LICENSE.MT_DATE_UPDATED DESC
    </select>

    <select id="findByHardware" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_HARDWARE = #{hardware}
        ORDER BY
        MT_LICENSE.MT_DATE_UPDATED DESC
    </select>

    <select id="findByEmailAndHardware" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_EMAIL = #{email}
        AND MT_LICENSE.MT_HARDWARE = #{hardware}
        ORDER BY
        MT_LICENSE.MT_DATE_UPDATED DESC
    </select>

    <insert id="create" parameterType="License">
        INSERT
        INTO MT_LICENSE (
        MT_LICENSE.MT_APP_NAME,
        MT_LICENSE.MT_EDITION,
        MT_LICENSE.MT_MAJOR_VERSION,
        MT_LICENSE.MT_EMAIL,
        MT_LICENSE.MT_HARDWARE,
        MT_LICENSE.MT_VALID_THROUGH,
        MT_LICENSE.MT_DATE_CREATED,
        MT_LICENSE.MT_DATE_UPDATED
        ) VALUES (
        #{appName},
        #{edition},
        #{majorVersion},
        #{email},
        #{hardware},
        #{validThrough},
        #{dateCreated},
        #{dateUpdated}
        )
    </insert>

    <update id="update" parameterType="License">
        UPDATE
        MT_LICENSE
        SET
        MT_LICENSE.MT_APP_NAME = #{appName},
        MT_LICENSE.MT_EDITION = #{edition},
        MT_LICENSE.MT_MAJOR_VERSION = #{majorVersion},
        MT_LICENSE.MT_EMAIL = #{email},
        MT_LICENSE.MT_HARDWARE = #{hardware},
        MT_LICENSE.MT_VALID_THROUGH = #{validThrough},
        MT_LICENSE.MT_DATE_UPDATED = #{dateUpdated}
        WHERE
        MT_LICENSE.MT_LICENSE_ID = #{licenseId}
    </update>

    <delete id="deleteByIds">
        DELETE
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_LICENSE_ID
        IN
        <foreach collection="array" item="licenseId" open="(" separator="," close=")">
            #{licenseId}
        </foreach>
    </delete>

    <delete id="deleteById">
        DELETE
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_LICENSE_ID = #{licenseId}
    </delete>

    <select id="searchByName" resultType="License">
        SELECT
        MT_LICENSE.MT_LICENSE_ID AS licenseId,
        MT_LICENSE.MT_APP_NAME AS appName,
        MT_LICENSE.MT_EDITION AS edition,
        MT_LICENSE.MT_MAJOR_VERSION AS majorVersion,
        MT_LICENSE.MT_EMAIL AS email,
        MT_LICENSE.MT_HARDWARE AS hardware,
        MT_LICENSE.MT_VALID_THROUGH AS validThrough,
        MT_LICENSE.MT_DATE_CREATED AS dateCreated,
        MT_LICENSE.MT_DATE_UPDATED AS dateUpdated
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_EMAIL LIKE "%"#{q}"%"
        ORDER BY
        MT_LICENSE.MT_DATE_UPDATED DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="findCount" resultType="long">
        SELECT
        COUNT(*)
        FROM MT_LICENSE
    </select>

    <select id="searchByNameCount" resultType="long">
        SELECT
        COUNT(*)
        FROM MT_LICENSE
        WHERE
        MT_LICENSE.MT_HARDWARE LIKE "%"#{q}"%"
    </select>

</mapper>